/*! For license information please see hls-parser.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.HLS=e():t.HLS=e()}(self,(()=>{return t={851:(t,e,n)=>{var r=n(771),a=r.getOptions,i=r.setOptions,o=n(463),s=n(367),c=n(890);t.exports={parse:o,stringify:s,types:c,getOptions:a,setOptions:i}},463:(t,e,n)=>{function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=n(771),c=n(890),u=c.Rendition,l=c.Variant,T=c.SessionData,E=c.Key,f=c.MediaInitializationSection,I=c.DateRange,h=c.SpliceInfo,A=c.MasterPlaylist,p=c.MediaPlaylist,d=c.Segment,S=c.PartialSegment,N=c.PrefetchSegment,y=c.RenditionReport;function v(t){return s.trim(t,'"')}function X(t){var e=s.splitAt(t,",");return{duration:s.toNumber(e[0]),title:decodeURIComponent(escape(e[1]))}}function m(t){var e=s.splitAt(t,"@");return{length:s.toNumber(e[0]),offset:e[1]?s.toNumber(e[1]):-1}}function R(t){var e=s.splitAt(t,"x");return{width:s.toNumber(e[0]),height:s.toNumber(e[1])}}function L(t){var e="ALLOWED-CPC: Each entry must consit of KEYFORMAT and Content Protection Configuration",n=t.split(",");0===n.length&&s.INVALIDPLAYLIST(e);var i,o=[],c=a(n);try{for(c.s();!(i=c.n()).done;){var u=i.value,l=r(s.splitAt(u,":"),2),T=l[0],E=l[1];T&&E?o.push({format:T,cpcList:E.split("/")}):s.INVALIDPLAYLIST(e)}}catch(t){c.e(t)}finally{c.f()}return o}function D(t){return t.startsWith('"')?v(t):t.startsWith("0x")||t.startsWith("0X")?s.hexToByteSequence(t):s.toNumber(t)}function g(t,e){e.IV&&t.compatibleVersion<2&&(t.compatibleVersion=2),(e.KEYFORMAT||e.KEYFORMATVERSIONS)&&t.compatibleVersion<5&&(t.compatibleVersion=5)}function O(t){var e,n,i,o={},c=a(s.splitByCommaWithPreservingQuotes(t));try{for(c.s();!(e=c.n()).done;){var u=e.value,l=r(s.splitAt(u,"="),2),T=l[0],E=l[1],f=v(E);switch(T){case"URI":o[T]=f;break;case"START-DATE":case"END-DATE":o[T]=new Date(f);break;case"IV":o[T]=(n=f,i=void 0,16!==(i=s.hexToByteSequence(n)).length&&s.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),i);break;case"BYTERANGE":o[T]=m(f);break;case"RESOLUTION":o[T]=R(f);break;case"ALLOWED-CPC":o[T]=L(f);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":o[T]="YES"===f;break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":case"SCORE":o[T]=s.toNumber(f);break;default:T.startsWith("SCTE35-")?o[T]=s.hexToByteSequence(f):T.startsWith("X-")?o[T]=D(E):("VIDEO-RANGE"===T&&"SDR"!==f&&"HLG"!==f&&"PQ"!==f&&s.INVALIDPLAYLIST('VIDEO-RANGE: unknown value "'.concat(f,'"')),o[T]=f)}}}catch(t){c.e(t)}finally{c.f()}return o}function P(){s.INVALIDPLAYLIST("The file contains both media and master playlist tags.")}function b(t,e,n){var r,i=(r=e.attributes,new u({type:r.TYPE,uri:r.URI,groupId:r["GROUP-ID"],language:r.LANGUAGE,assocLanguage:r["ASSOC-LANGUAGE"],name:r.NAME,isDefault:r.DEFAULT,autoselect:r.AUTOSELECT,forced:r.FORCED,instreamId:r["INSTREAM-ID"],characteristics:r.CHARACTERISTICS,channels:r.CHANNELS})),o=t[s.camelify(n)],c=function(t,e){var n,r=!1,i=a(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.name===e.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";o.isDefault&&(r=!0)}}catch(t){i.e(t)}finally{i.f()}return r&&e.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(o,i);c&&s.INVALIDPLAYLIST(c),o.push(i),i.isDefault&&(t.currentRenditions[s.camelify(n)]=o.length-1)}function C(t,e,n,r,i){var o,c=new l({uri:n,bandwidth:e.BANDWIDTH,averageBandwidth:e["AVERAGE-BANDWIDTH"],score:e.SCORE,codecs:e.CODECS,resolution:e.RESOLUTION,frameRate:e["FRAME-RATE"],hdcpLevel:e["HDCP-LEVEL"],allowedCpc:e["ALLOWED-CPC"],videoRange:e["VIDEO-RANGE"],stableVariantId:e["STABLE-VARIANT-ID"]}),u=a(t);try{for(u.s();!(o=u.n()).done;){var T=o.value;if("EXT-X-MEDIA"===T.name){var E=T.attributes,f=E.TYPE;if(f&&E["GROUP-ID"]||s.INVALIDPLAYLIST("EXT-X-MEDIA TYPE attribute is REQUIRED."),e[f]===E["GROUP-ID"]&&(b(c,T,f),"CLOSED-CAPTIONS"===f)){var I,h=a(c.closedCaptions);try{for(h.s();!(I=h.n()).done;){var A=I.value.instreamId;if(A&&A.startsWith("SERVICE")&&i.compatibleVersion<7){i.compatibleVersion=7;break}}}catch(t){h.e(t)}finally{h.f()}}}}}catch(t){u.e(t)}finally{u.f()}return function(t,e,n){for(var r=function(){var r=i[a];"CLOSED-CAPTIONS"===r&&"NONE"===t[r]?(n.isClosedCaptionsNone=!0,e.closedCaptions=[]):t[r]&&!e[s.camelify(r)].some((function(e){return e.groupId===t[r]}))&&s.INVALIDPLAYLIST("".concat(r," attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ").concat(r,"."))},a=0,i=["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"];a<i.length;a++)r()}(e,c,i),c.isIFrameOnly=r,c}function M(t,e){if(t.method!==e.method)return!1;if(t.uri!==e.uri)return!1;if(t.iv){if(!e.iv)return!1;if(t.iv.length!==e.iv.length)return!1;for(var n=0;n<t.iv.length;n++)if(t.iv[n]!==e.iv[n])return!1}else if(e.iv)return!1;return t.format===e.format&&t.formatVersion===e.formatVersion}function U(t,e,n,r,a,i,o){for(var c=new d({uri:e,mediaSequenceNumber:a,discontinuitySequence:i}),u=!1,l=!1,T=n;T<=r;T++){var A=t[T],p=A.name,N=A.value,y=A.attributes;if("EXTINF"===p)!Number.isInteger(N.duration)&&o.compatibleVersion<3&&(o.compatibleVersion=3),Math.round(N.duration)>o.targetDuration&&s.INVALIDPLAYLIST("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration"),c.duration=N.duration,c.title=N.title;else if("EXT-X-BYTERANGE"===p)o.compatibleVersion<4&&(o.compatibleVersion=4),c.byterange=N;else if("EXT-X-DISCONTINUITY"===p)c.parts.length>0&&s.INVALIDPLAYLIST("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment."),c.discontinuity=!0;else if("EXT-X-KEY"===p)c.parts.length>0&&s.INVALIDPLAYLIST("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment."),g(o,y),c.key=new E({method:y.METHOD,uri:y.URI,iv:y.IV,format:y.KEYFORMAT,formatVersion:y.KEYFORMATVERSIONS});else if("EXT-X-MAP"===p)c.parts.length>0&&s.INVALIDPLAYLIST("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment."),o.compatibleVersion<5&&(o.compatibleVersion=5),o.hasMap=!0,c.map=new f({uri:y.URI,byterange:y.BYTERANGE});else if("EXT-X-PROGRAM-DATE-TIME"===p)c.programDateTime=N;else if("EXT-X-DATERANGE"===p){for(var v={},X=0,m=Object.keys(y);X<m.length;X++){var R=m[X];(R.startsWith("SCTE35-")||R.startsWith("X-"))&&(v[R]=y[R])}c.dateRange=new I({id:y.ID,classId:y.CLASS,start:y["START-DATE"],end:y["END-DATE"],duration:y.DURATION,plannedDuration:y["PLANNED-DURATION"],endOnNext:y["END-ON-NEXT"],attributes:v})}else if("EXT-X-CUE-OUT"===p)c.markers.push(new h({type:"OUT",duration:y&&y.DURATION||N}));else if("EXT-X-CUE-IN"===p)c.markers.push(new h({type:"IN"}));else if("EXT-X-CUE-OUT-CONT"===p||"EXT-X-CUE"===p||"EXT-OATCLS-SCTE35"===p||"EXT-X-ASSET"===p||"EXT-X-SCTE35"===p)c.markers.push(new h({type:"RAW",tagName:p,value:N}));else if("EXT-X-PRELOAD-HINT"!==p||y.TYPE)if("EXT-X-PRELOAD-HINT"===p&&"PART"===y.TYPE&&l)s.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.");else if("EXT-X-PART"!==p&&"EXT-X-PRELOAD-HINT"!==p||y.URI){if("EXT-X-PRELOAD-HINT"===p&&"MAP"===y.TYPE)u&&s.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist."),u=!0,o.hasMap=!0,c.map=new f({hint:!0,uri:y.URI,byterange:{length:y["BYTERANGE-LENGTH"],offset:y["BYTERANGE-START"]||0}});else if("EXT-X-PART"===p||"EXT-X-PRELOAD-HINT"===p&&"PART"===y.TYPE){"EXT-X-PART"!==p||y.DURATION||s.INVALIDPLAYLIST("EXT-X-PART: DURATION attribute is mandatory"),"EXT-X-PRELOAD-HINT"===p&&(l=!0);var L=new S({hint:"EXT-X-PRELOAD-HINT"===p,uri:y.URI,byterange:"EXT-X-PART"===p?y.BYTERANGE:{length:y["BYTERANGE-LENGTH"],offset:y["BYTERANGE-START"]||0},duration:y.DURATION,independent:y.INDEPENDENT,gap:y.GAP});c.parts.push(L)}}else s.INVALIDPLAYLIST("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory");else s.INVALIDPLAYLIST("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory")}return c}function Y(t,e,n,r,a,i,o){for(var c=new N({uri:e,mediaSequenceNumber:a,discontinuitySequence:i}),u=n;u<=r;u++){var l=t[u],T=l.name,f=l.attributes;"EXTINF"===T?s.INVALIDPLAYLIST("A prefetch segment must not be advertised with an EXTINF tag."):"EXT-X-DISCONTINUITY"===T?s.INVALIDPLAYLIST("A prefetch segment must not be advertised with an EXT-X-DISCONTINUITY tag."):"EXT-X-PREFETCH-DISCONTINUITY"===T?c.discontinuity=!0:"EXT-X-KEY"===T?(g(o,f),c.key=new E({method:f.METHOD,uri:f.URI,iv:f.IV,format:f.KEYFORMAT,formatVersion:f.KEYFORMATVERSIONS})):"EXT-X-MAP"===T&&s.INVALIDPLAYLIST("Prefetch segments must not be advertised with an EXT-X-MAP tag.")}return c}function V(t,e){var n,i=new p,o=-1,c=0,u=!1,l=!1,T=0,E=null,f=null,I=!1,h=a(t.entries());try{for(h.s();!(n=h.n()).done;){var A=r(n.value,2),d=A[0],S=A[1],N=S.name,v=S.value,X=S.attributes;if("Segment"!==S.category){if("EXT-X-VERSION"===N)void 0===i.version?i.version=v:s.INVALIDPLAYLIST("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.");else if("EXT-X-TARGETDURATION"===N)i.targetDuration=e.targetDuration=v;else if("EXT-X-MEDIA-SEQUENCE"===N)i.segments.length>0&&s.INVALIDPLAYLIST("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),i.mediaSequenceBase=c=v;else if("EXT-X-DISCONTINUITY-SEQUENCE"===N)i.segments.length>0&&s.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),u&&s.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag."),i.discontinuitySequenceBase=T=v;else if("EXT-X-ENDLIST"===N)i.endlist=!0;else if("EXT-X-PLAYLIST-TYPE"===N)i.playlistType=v;else if("EXT-X-I-FRAMES-ONLY"===N)e.compatibleVersion<4&&(e.compatibleVersion=4),i.isIFrame=!0;else if("EXT-X-INDEPENDENT-SEGMENTS"===N)i.independentSegments&&s.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),i.independentSegments=!0;else if("EXT-X-START"===N)i.start&&s.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof X["TIME-OFFSET"]&&s.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),i.start={offset:X["TIME-OFFSET"],precise:X.PRECISE||!1};else if("EXT-X-SERVER-CONTROL"===N)X["CAN-BLOCK-RELOAD"]||s.INVALIDPLAYLIST("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS"),i.lowLatencyCompatibility={canBlockReload:X["CAN-BLOCK-RELOAD"],canSkipUntil:X["CAN-SKIP-UNTIL"],holdBack:X["HOLD-BACK"],partHoldBack:X["PART-HOLD-BACK"]};else if("EXT-X-PART-INF"===N)X["PART-TARGET"]||s.INVALIDPLAYLIST("EXT-X-PART-INF: PART-TARGET attribute is mandatory"),i.partTargetDuration=X["PART-TARGET"];else if("EXT-X-RENDITION-REPORT"===N)X.URI||s.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI attribute is mandatory"),0===X.URI.search(/^[a-z]+:/)&&s.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri"),i.renditionReports.push(new y({uri:X.URI,lastMSN:X["LAST-MSN"],lastPart:X["LAST-PART"]}));else if("EXT-X-SKIP"===N)X["SKIPPED-SEGMENTS"]||s.INVALIDPLAYLIST("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory"),e.compatibleVersion<9&&(e.compatibleVersion=9),i.skip=X["SKIPPED-SEGMENTS"],c+=i.skip;else if("EXT-X-PREFETCH"===N){var m=Y(t,v,-1===o?d:o,d-1,c++,T,e);m&&(m.discontinuity&&(m.discontinuitySequence++,T=m.discontinuitySequence),m.key?E=m.key:m.key=E,i.prefetchSegments.push(m)),l=!0,o=-1}else if("string"==typeof S){-1===o&&s.INVALIDPLAYLIST("A URI line is not preceded by any segment tags"),i.targetDuration||s.INVALIDPLAYLIST("The EXT-X-TARGETDURATION tag is REQUIRED"),l&&s.INVALIDPLAYLIST("These segments must appear after all complete segments.");var R=U(t,S,o,d-1,c++,T,e);if(R){var L=r(w(i,R,T,E,f),3);T=L[0],E=L[1],f=L[2],!I&&R.parts.length>0&&(I=!0)}o=-1}}else-1===o&&(o=d),"EXT-X-DISCONTINUITY"===N&&(u=!0)}}catch(t){h.e(t)}finally{h.f()}if(-1!==o){var D=U(t,"",o,t.length-1,c++,T,e);if(D){var g=D.parts;g.length>0&&!i.endlist&&!g[g.length-1].hint&&s.INVALIDPLAYLIST("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute"),w(i,D,E,f),!I&&D.parts.length>0&&(I=!0)}}return function(t){for(var e=new Map,n=new Map,r=!1,i=!1,o=t.length-1;o>=0;o--){var c=t[o],u=c.programDateTime,l=c.dateRange;if(u&&(i=!0),l&&l.start){r=!0,l.endOnNext&&(l.end||l.duration)&&s.INVALIDPLAYLIST("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.");var T=l.start.getTime(),E=l.duration||0;l.end&&l.duration&&T+1e3*E!==l.end.getTime()&&s.INVALIDPLAYLIST("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION"),l.endOnNext&&(l.end=e.get(l.classId)),e.set(l.classId,l.start);var f=l.end?l.end.getTime():l.start.getTime()+1e3*(l.duration||0),I=n.get(l.classId);if(I){var h,A=a(I);try{for(A.s();!(h=A.n()).done;){var p=h.value;(p.start<=T&&p.end>T||p.start>=T&&p.start<f)&&s.INVALIDPLAYLIST("DATERANGE tags with the same CLASS should not overlap")}}catch(t){A.e(t)}finally{A.f()}I.push({start:T,end:f})}else n.set(l.classId,[{start:T,end:f}])}}r&&!i&&s.INVALIDPLAYLIST("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.")}(i.segments),i.lowLatencyCompatibility&&function(t,e){var n=t.lowLatencyCompatibility,i=t.targetDuration,o=t.partTargetDuration,c=t.segments,u=t.renditionReports,l=n.canSkipUntil,T=n.holdBack,E=n.partHoldBack;if(l<6*i&&s.INVALIDPLAYLIST("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION."),T<3*i&&s.INVALIDPLAYLIST("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION."),e){void 0===o&&s.INVALIDPLAYLIST("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags"),void 0===E&&s.INVALIDPLAYLIST("EXT-X-PART: PART-HOLD-BACK attribute is mandatory"),E<o&&s.INVALIDPLAYLIST("PART-HOLD-BACK must be at least PART-TARGET");var f,I=a(c.entries());try{for(I.s();!(f=I.n()).done;){var h=r(f.value,2),A=h[0],p=h[1].parts;p.length>0&&A<c.length-3&&s.INVALIDPLAYLIST("Remove EXT-X-PART tags from the Playlist after they are greater than three target durations from the end of the Playlist.");var d,S=a(p.entries());try{for(S.s();!(d=S.n()).done;){var N=r(d.value,2),y=N[0],v=N[1].duration;void 0!==v&&(v>o&&s.INVALIDPLAYLIST("PART-TARGET is the maximum duration of any Partial Segment"),y<p.length-1&&v<.85*o&&s.INVALIDPLAYLIST("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET"))}}catch(t){S.e(t)}finally{S.f()}}}catch(t){I.e(t)}finally{I.f()}}var X,m=a(u);try{for(m.s();!(X=m.n()).done;){var R=X.value,L=c[c.length-1];R.lastMSN||(R.lastMSN=L.mediaSequenceNumber),!R.lastPart&&L.parts.length>0&&(R.lastPart=L.parts.length-1)}}catch(t){m.e(t)}finally{m.f()}}(i,I),i}function w(t,e,n,r,a){var i=e.discontinuity,o=e.key,c=e.map,u=e.byterange,l=e.uri;if(i&&(e.discontinuitySequence=n+1),o||(e.key=r),c||(e.map=a),u&&-1===u.offset){var T=t.segments;if(T.length>0){var E=T[T.length-1];E.byterange&&E.uri===l?u.offset=E.byterange.offset+E.byterange.length:s.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource")}else s.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file")}return t.segments.push(e),[e.discontinuitySequence,e.key,e.map]}function F(t,e){var n=function(t){var e=t.indexOf(":");return-1===e?[t.slice(1).trim(),null]:[t.slice(1,e).trim(),t.slice(e+1).trim()]}(t),a=r(n,2),i=a[0],o=a[1],c=function(t){switch(t){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-PREFETCH-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PREFETCH":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(i);if(function(t,e){if("Segment"===t||"MediaPlaylist"===t)return void 0===e.isMasterPlaylist?void(e.isMasterPlaylist=!1):void(e.isMasterPlaylist&&P());if("MasterPlaylist"===t){if(void 0===e.isMasterPlaylist)return void(e.isMasterPlaylist=!0);!1===e.isMasterPlaylist&&P()}}(c,e),"Unknown"===c)return null;"MediaPlaylist"===c&&"EXT-X-RENDITION-REPORT"!==i&&"EXT-X-PREFETCH"!==i&&(e.hash[i]&&s.INVALIDPLAYLIST("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist"),e.hash[i]=!0);var u=function(t,e){switch(t){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":return[s.toNumber(e),null];case"EXT-X-CUE-OUT":return Number.isNaN(Number(e))?[null,O(e)]:[s.toNumber(e),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,O(e)];case"EXTINF":return[X(e),null];case"EXT-X-BYTERANGE":return[m(e),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(e),null];default:return[e,null]}}(i,o),l=r(u,2);return{name:i,category:c,value:l[0],attributes:l[1]}}function G(t,e){var n;return e.isMasterPlaylist?n=function(t,e){var n,i=new A,o=!1,c=a(t.entries());try{for(c.s();!(n=c.n()).done;){var u=r(n.value,2),l=u[0],f=u[1],I=f.name,h=f.value,p=f.attributes;if("EXT-X-VERSION"===I)i.version=h;else if("EXT-X-STREAM-INF"===I){var d=t[l+1];("string"!=typeof d||d.startsWith("#EXT"))&&s.INVALIDPLAYLIST("EXT-X-STREAM-INF must be followed by a URI line");var S=C(t,p,d,!1,e);S&&("number"==typeof S.score&&(o=!0,S.score<0&&s.INVALIDPLAYLIST("SCORE attribute on EXT-X-STREAM-INF must be positive decimal-floating-point number.")),i.variants.push(S))}else if("EXT-X-I-FRAME-STREAM-INF"===I){var N=C(t,p,p.URI,!0,e);N&&i.variants.push(N)}else"EXT-X-SESSION-DATA"===I?function(){var t=new T({id:p["DATA-ID"],value:p.VALUE,uri:p.URI,language:p.LANGUAGE});i.sessionDataList.some((function(e){return e.id===t.id&&e.language===t.language}))&&s.INVALIDPLAYLIST("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute."),i.sessionDataList.push(t)}():"EXT-X-SESSION-KEY"===I?function(){"NONE"===p.METHOD&&s.INVALIDPLAYLIST("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE");var t=new E({method:p.METHOD,uri:p.URI,iv:p.IV,format:p.KEYFORMAT,formatVersion:p.KEYFORMATVERSIONS});i.sessionKeyList.some((function(e){return M(e,t)}))&&s.INVALIDPLAYLIST("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values."),g(e,p),i.sessionKeyList.push(t)}():"EXT-X-INDEPENDENT-SEGMENTS"===I?(i.independentSegments&&s.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),i.independentSegments=!0):"EXT-X-START"===I&&(i.start&&s.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof p["TIME-OFFSET"]&&s.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),i.start={offset:p["TIME-OFFSET"],precise:p.PRECISE||!1})}}catch(t){c.e(t)}finally{c.f()}if(o){var y,v=a(i.variants);try{for(v.s();!(y=v.n()).done;)"number"!=typeof y.value.score&&s.INVALIDPLAYLIST("If any Variant Stream contains the SCORE attribute, then all Variant Streams in the Master Playlist SHOULD have a SCORE attribute")}catch(t){v.e(t)}finally{v.f()}}if(e.isClosedCaptionsNone){var X,m=a(i.variants);try{for(m.s();!(X=m.n()).done;)X.value.closedCaptions.length>0&&s.INVALIDPLAYLIST("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE")}catch(t){m.e(t)}finally{m.f()}}return i}(t,e):!(n=V(t,e)).isIFrame&&e.hasMap&&e.compatibleVersion<6&&(e.compatibleVersion=6),e.compatibleVersion>1&&(!n.version||n.version<e.compatibleVersion)&&s.INVALIDPLAYLIST("EXT-X-VERSION needs to be ".concat(e.compatibleVersion," or higher.")),n}t.exports=function(t){var e={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},n=function(t,e){var n,r=[],i=a(t.split("\n"));try{for(i.s();!(n=i.n()).done;){var o=n.value,c=Buffer.from(o.trim()).toString();if(c)if(c.startsWith("#")){if(c.startsWith("#EXT")){var u=F(c,e);u&&r.push(u)}}else r.push(c)}}catch(t){i.e(t)}finally{i.f()}return 0!==r.length&&"EXTM3U"===r[0].name||s.INVALIDPLAYLIST("The EXTM3U tag MUST be the first line."),r}(t,e),r=G(n,e);return r.source=t,r}},367:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function o(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,o=void 0,o=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===r(o)?o:String(o)),a)}var i,o}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=l(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}},u.apply(this,arguments)}function l(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function T(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){var e="function"==typeof Map?new Map:void 0;return E=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return f(t,arguments,A(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,t)},E(t)}function f(t,e,n){return f=I()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var a=new(Function.bind.apply(t,r));return n&&h(a,n.prototype),a},f.apply(null,arguments)}function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}var p=n(771),d=["#EXTINF","#EXT-X-BYTERANGE","#EXT-X-DISCONTINUITY","#EXT-X-STREAM-INF","#EXT-X-CUE-OUT","#EXT-X-CUE-IN","#EXT-X-KEY","#EXT-X-MAP"],S=["#EXT-X-MEDIA"],N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(s,t);var e,n,r,a,i,o=(e=s,n=I(),function(){var t,r=A(e);if(n){var a=A(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return T(this,t)});function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this)).baseUri=t,e}return r=s,a=[{key:"push",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var a=function(){var e=o[i];if(!e.startsWith("#"))return u(A(s.prototype),"push",t).call(t,e),"continue";if(d.some((function(t){return e.startsWith(t)})))return u(A(s.prototype),"push",t).call(t,e),"continue";if(t.includes(e)){if(S.some((function(t){return e.startsWith(t)})))return"continue";p.INVALIDPLAYLIST("Redundant item (".concat(e,")"))}u(A(s.prototype),"push",t).call(t,e)},i=0,o=n;i<o.length;i++)a()}}],a&&c(r.prototype,a),i&&c(r,i),Object.defineProperty(r,"prototype",{writable:!1}),s}(E(Array));function y(t,e){var n=1e3;e&&(n=Math.pow(10,e));var r=Math.round(t*n)/n;return e?r.toFixed(e):r}function v(t){var e=t.toString(10),n=e.indexOf(".");return-1===n?0:e.length-n-1}function X(t){var e=['DATA-ID="'.concat(t.id,'"')];return t.language&&e.push('LANGUAGE="'.concat(t.language,'"')),t.value?e.push('VALUE="'.concat(t.value,'"')):t.uri&&e.push('URI="'.concat(t.uri,'"')),"#EXT-X-SESSION-DATA:".concat(e.join(","))}function m(t,e){var n=e?"#EXT-X-SESSION-KEY":"#EXT-X-KEY",r=["METHOD=".concat(t.method)];return t.uri&&r.push('URI="'.concat(t.uri,'"')),t.iv&&(16!==t.iv.length&&p.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),r.push("IV=".concat(p.byteSequenceToHex(t.iv)))),t.format&&r.push('KEYFORMAT="'.concat(t.format,'"')),t.formatVersion&&r.push('KEYFORMATVERSIONS="'.concat(t.formatVersion,'"')),"".concat(n,":").concat(r.join(","))}function R(t,e){var n=e.isIFrameOnly?"#EXT-X-I-FRAME-STREAM-INF":"#EXT-X-STREAM-INF",r=["BANDWIDTH=".concat(e.bandwidth)];if(e.averageBandwidth&&r.push("AVERAGE-BANDWIDTH=".concat(e.averageBandwidth)),e.isIFrameOnly&&r.push('URI="'.concat(e.uri,'"')),e.codecs&&r.push('CODECS="'.concat(e.codecs,'"')),e.resolution&&r.push("RESOLUTION=".concat(e.resolution.width,"x").concat(e.resolution.height)),e.frameRate&&r.push("FRAME-RATE=".concat(y(e.frameRate,3))),e.hdcpLevel&&r.push("HDCP-LEVEL=".concat(e.hdcpLevel)),e.audio.length>0){r.push('AUDIO="'.concat(e.audio[0].groupId,'"'));var a,o=i(e.audio);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(L(s))}}catch(t){o.e(t)}finally{o.f()}}if(e.video.length>0){r.push('VIDEO="'.concat(e.video[0].groupId,'"'));var c,u=i(e.video);try{for(u.s();!(c=u.n()).done;){var l=c.value;t.push(L(l))}}catch(t){u.e(t)}finally{u.f()}}if(e.subtitles.length>0){r.push('SUBTITLES="'.concat(e.subtitles[0].groupId,'"'));var T,E=i(e.subtitles);try{for(E.s();!(T=E.n()).done;){var f=T.value;t.push(L(f))}}catch(t){E.e(t)}finally{E.f()}}if(p.getOptions().allowClosedCaptionsNone&&0===e.closedCaptions.length)r.push("CLOSED-CAPTIONS=NONE");else if(e.closedCaptions.length>0){r.push('CLOSED-CAPTIONS="'.concat(e.closedCaptions[0].groupId,'"'));var I,h=i(e.closedCaptions);try{for(h.s();!(I=h.n()).done;){var A=I.value;t.push(L(A))}}catch(t){h.e(t)}finally{h.f()}}if(e.score&&r.push("SCORE=".concat(e.score)),e.allowedCpc){var d,S=[],N=i(e.allowedCpc);try{for(N.s();!(d=N.n()).done;){var v=d.value,X=v.format,m=v.cpcList;S.push("".concat(X,":").concat(m.join("/")))}}catch(t){N.e(t)}finally{N.f()}r.push('ALLOWED-CPC="'.concat(S.join(","),'"'))}e.videoRange&&r.push("VIDEO-RANGE=".concat(e.videoRange)),e.stableVariantId&&r.push('STABLE-VARIANT-ID="'.concat(e.stableVariantId,'"')),t.push("".concat(n,":").concat(r.join(","))),e.isIFrameOnly||t.push("".concat(e.uri))}function L(t){var e=["TYPE=".concat(t.type),'GROUP-ID="'.concat(t.groupId,'"'),'NAME="'.concat(t.name,'"')];return void 0!==t.isDefault&&e.push("DEFAULT=".concat(t.isDefault?"YES":"NO")),void 0!==t.autoselect&&e.push("AUTOSELECT=".concat(t.autoselect?"YES":"NO")),void 0!==t.forced&&e.push("FORCED=".concat(t.forced?"YES":"NO")),t.language&&e.push('LANGUAGE="'.concat(t.language,'"')),t.assocLanguage&&e.push('ASSOC-LANGUAGE="'.concat(t.assocLanguage,'"')),t.instreamId&&e.push('INSTREAM-ID="'.concat(t.instreamId,'"')),t.characteristics&&e.push('CHARACTERISTICS="'.concat(t.characteristics,'"')),t.channels&&e.push('CHANNELS="'.concat(t.channels,'"')),t.uri&&e.push('URI="'.concat(t.uri,'"')),"#EXT-X-MEDIA:".concat(e.join(","))}function D(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=!1,o="";if(e.discontinuity&&t.push("#EXT-X-DISCONTINUITY"),e.key){var s=m(e.key);s!==n&&(t.push(s),n=s)}if(e.map){var c=g(e.map);c!==r&&(t.push(c),r=c)}if(e.programDateTime&&t.push("#EXT-X-PROGRAM-DATE-TIME:".concat(p.formatDate(e.programDateTime))),e.dateRange&&t.push(P(e.dateRange)),e.markers.length>0&&(o=b(t,e.markers)),e.parts.length>0&&(i=C(t,e.parts)),i)return[n,r];var u=a<3?Math.round(e.duration):y(e.duration,v(e.duration));return t.push("#EXTINF:".concat(u,",").concat(unescape(encodeURIComponent(e.title||"")))),e.byterange&&t.push("#EXT-X-BYTERANGE:".concat(O(e.byterange))),Array.prototype.push.call(t,"".concat(e.uri)),[n,r,o]}function g(t){var e=['URI="'.concat(t.uri,'"')];return t.byterange&&e.push('BYTERANGE="'.concat(O(t.byterange),'"')),"#EXT-X-MAP:".concat(e.join(","))}function O(t){var e=t.offset,n=t.length;return"".concat(n,"@").concat(e)}function P(t){var e=['ID="'.concat(t.id,'"')];t.start&&e.push('START-DATE="'.concat(p.formatDate(t.start),'"')),t.end&&e.push('END-DATE="'.concat(t.end,'"')),t.duration&&e.push("DURATION=".concat(t.duration)),t.plannedDuration&&e.push("PLANNED-DURATION=".concat(t.plannedDuration)),t.classId&&e.push('CLASS="'.concat(t.classId,'"')),t.endOnNext&&e.push("END-ON-NEXT=YES");for(var n=0,r=Object.keys(t.attributes);n<r.length;n++){var a=r[n];a.startsWith("X-")?"number"==typeof t.attributes[a]?e.push("".concat(a,"=").concat(t.attributes[a])):e.push("".concat(a,'="').concat(t.attributes[a],'"')):a.startsWith("SCTE35-")&&e.push("".concat(a,"=").concat(p.byteSequenceToHex(t.attributes[a])))}return"#EXT-X-DATERANGE:".concat(e.join(","))}function b(t,e){var n,r="",a=i(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;if("OUT"===o.type)r="OUT",t.push("#EXT-X-CUE-OUT:DURATION=".concat(o.duration));else if("IN"===o.type)r="IN",t.push("#EXT-X-CUE-IN");else if("RAW"===o.type){var s=o.value?":".concat(o.value):"";t.push("#".concat(o.tagName).concat(s))}}}catch(t){a.e(t)}finally{a.f()}return r}function C(t,e){var n,r=!1,a=i(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.hint){var s=[];if(s.push("TYPE=PART",'URI="'.concat(o.uri,'"')),o.byterange){var c=o.byterange,u=c.offset,l=c.length;s.push("BYTERANGE-START=".concat(u)),l&&s.push("BYTERANGE-LENGTH=".concat(l))}t.push("#EXT-X-PRELOAD-HINT:".concat(s.join(","))),r=!0}else{var T=[];T.push("DURATION=".concat(o.duration),'URI="'.concat(o.uri,'"')),o.byterange&&T.push("BYTERANGE=".concat(O(o.byterange))),o.independent&&T.push("INDEPENDENT=YES"),o.gap&&T.push("GAP=YES"),t.push("#EXT-X-PART:".concat(T.join(",")))}}}catch(t){a.e(t)}finally{a.f()}return r}t.exports=function(t){p.PARAMCHECK(t),p.ASSERT("Not a playlist","playlist"===t.type);var e=new N(t.uri);return e.push("#EXTM3U"),t.version&&e.push("#EXT-X-VERSION:".concat(t.version)),t.independentSegments&&e.push("#EXT-X-INDEPENDENT-SEGMENTS"),t.start&&e.push("#EXT-X-START:TIME-OFFSET=".concat(y(t.start.offset)).concat(t.start.precise?",PRECISE=YES":"")),t.isMasterPlaylist?function(t,e){var n,r=i(e.sessionDataList);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.push(X(a))}}catch(t){r.e(t)}finally{r.f()}var o,s=i(e.sessionKeyList);try{for(s.s();!(o=s.n()).done;){var c=o.value;t.push(m(c,!0))}}catch(t){s.e(t)}finally{s.f()}var u,l=i(e.variants);try{for(l.s();!(u=l.n()).done;)R(t,u.value)}catch(t){l.e(t)}finally{l.f()}}(e,t):function(t,e){var n="",r="",o=!1;if(e.targetDuration&&t.push("#EXT-X-TARGETDURATION:".concat(e.targetDuration)),e.lowLatencyCompatibility){var s=e.lowLatencyCompatibility,c=s.canBlockReload,u=s.canSkipUntil,l=s.holdBack,T=s.partHoldBack,E=[];E.push("CAN-BLOCK-RELOAD=".concat(c?"YES":"NO")),void 0!==u&&E.push("CAN-SKIP-UNTIL=".concat(u)),void 0!==l&&E.push("HOLD-BACK=".concat(l)),void 0!==T&&E.push("PART-HOLD-BACK=".concat(T)),t.push("#EXT-X-SERVER-CONTROL:".concat(E.join(",")))}e.partTargetDuration&&t.push("#EXT-X-PART-INF:PART-TARGET=".concat(e.partTargetDuration)),e.mediaSequenceBase&&t.push("#EXT-X-MEDIA-SEQUENCE:".concat(e.mediaSequenceBase)),e.discontinuitySequenceBase&&t.push("#EXT-X-DISCONTINUITY-SEQUENCE:".concat(e.discontinuitySequenceBase)),e.playlistType&&t.push("#EXT-X-PLAYLIST-TYPE:".concat(e.playlistType)),e.isIFrame&&t.push("#EXT-X-I-FRAMES-ONLY"),e.skip>0&&t.push("#EXT-X-SKIP:SKIPPED-SEGMENTS=".concat(e.skip));var f,I=i(e.segments);try{for(I.s();!(f=I.n()).done;){var h,A=a(D(t,f.value,n,r,e.version),3);n=A[0],r=A[1],"OUT"===(h=A[2])?o=!0:"IN"===h&&o&&(o=!1)}}catch(t){I.e(t)}finally{I.f()}"VOD"===e.playlistType&&o&&t.push("#EXT-X-CUE-IN"),e.prefetchSegments.length>2&&p.INVALIDPLAYLIST("The server must deliver no more than two prefetch segments");var d,S=i(e.prefetchSegments);try{for(S.s();!(d=S.n()).done;){var N=d.value;N.discontinuity&&t.push("#EXT-X-PREFETCH-DISCONTINUITY"),t.push("#EXT-X-PREFETCH:".concat(N.uri))}}catch(t){S.e(t)}finally{S.f()}e.endlist&&t.push("#EXT-X-ENDLIST");var y,v=i(e.renditionReports);try{for(v.s();!(y=v.n()).done;){var X=y.value,m=[];m.push('URI="'.concat(X.uri,'"'),"LAST-MSN=".concat(X.lastMSN)),void 0!==X.lastPart&&m.push("LAST-PART=".concat(X.lastPart)),t.push("#EXT-X-RENDITION-REPORT:".concat(m.join(",")))}}catch(t){v.e(t)}finally{v.f()}}(e,t),e.join("\n")}},890:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=c(t);if(e){var a=c(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return s(this,n)}}function s(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function u(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,o=void 0,o=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===r(o)?o:String(o)),a)}var i,o}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var E=n(771),f=l((function t(e){var n=e.type,r=e.uri,a=e.groupId,i=e.language,o=e.assocLanguage,s=e.name,c=e.isDefault,u=e.autoselect,l=e.forced,f=e.instreamId,I=e.characteristics,h=e.channels;T(this,t),E.PARAMCHECK(n,a,s),E.CONDITIONALASSERT(["SUBTITLES"===n,r],["CLOSED-CAPTIONS"===n,f],["CLOSED-CAPTIONS"===n,!r],[l,"SUBTITLES"===n]),this.type=n,this.uri=r,this.groupId=a,this.language=i,this.assocLanguage=o,this.name=s,this.isDefault=c,this.autoselect=u,this.forced=l,this.instreamId=f,this.characteristics=I,this.channels=h})),I=l((function t(e){var n=e.uri,r=e.isIFrameOnly,a=void 0!==r&&r,i=e.bandwidth,o=e.averageBandwidth,s=e.score,c=e.codecs,u=e.resolution,l=e.frameRate,f=e.hdcpLevel,I=e.allowedCpc,h=e.videoRange,A=e.stableVariantId,p=e.audio,d=void 0===p?[]:p,S=e.video,N=void 0===S?[]:S,y=e.subtitles,v=void 0===y?[]:y,X=e.closedCaptions,m=void 0===X?[]:X,R=e.currentRenditions,L=void 0===R?{audio:0,video:0,subtitles:0,closedCaptions:0}:R;T(this,t),E.PARAMCHECK(n,i),this.uri=n,this.isIFrameOnly=a,this.bandwidth=i,this.averageBandwidth=o,this.score=s,this.codecs=c,this.resolution=u,this.frameRate=l,this.hdcpLevel=f,this.allowedCpc=I,this.videoRange=h,this.stableVariantId=A,this.audio=d,this.video=N,this.subtitles=v,this.closedCaptions=m,this.currentRenditions=L})),h=l((function t(e){var n=e.id,r=e.value,a=e.uri,i=e.language;T(this,t),E.PARAMCHECK(n,r||a),E.ASSERT("SessionData cannot have both value and uri, shoud be either.",!(r&&a)),this.id=n,this.value=r,this.uri=a,this.language=i})),A=l((function t(e){var n=e.method,r=e.uri,a=e.iv,i=e.format,o=e.formatVersion;T(this,t),E.PARAMCHECK(n),E.CONDITIONALPARAMCHECK(["NONE"!==n,r]),E.CONDITIONALASSERT(["NONE"===n,!(r||a||i||o)]),this.method=n,this.uri=r,this.iv=a,this.format=i,this.formatVersion=o})),p=l((function t(e){var n=e.hint,r=void 0!==n&&n,a=e.uri,i=e.mimeType,o=e.byterange;T(this,t),E.PARAMCHECK(a),this.hint=r,this.uri=a,this.mimeType=i,this.byterange=o})),d=l((function t(e){var n=e.id,r=e.classId,a=e.start,i=e.end,o=e.duration,s=e.plannedDuration,c=e.endOnNext,u=e.attributes,l=void 0===u?{}:u;T(this,t),E.PARAMCHECK(n),E.CONDITIONALPARAMCHECK([!0===c,r]),E.CONDITIONALASSERT([i,a],[i,a<=i],[o,o>=0],[s,s>=0]),this.id=n,this.classId=r,this.start=a,this.end=i,this.duration=o,this.plannedDuration=s,this.endOnNext=c,this.attributes=l})),S=l((function t(e){var n=e.type,r=e.duration,a=e.tagName,i=e.value;T(this,t),E.PARAMCHECK(n),E.CONDITIONALPARAMCHECK(["OUT"===n,r]),E.CONDITIONALPARAMCHECK(["RAW"===n,a]),this.type=n,this.duration=r,this.tagName=a,this.value=i})),N=l((function t(e){T(this,t),E.PARAMCHECK(e),this.type=e})),y=function(t){a(n,t);var e=o(n);function n(t){var r,a=t.isMasterPlaylist,i=t.uri,o=t.version,s=t.independentSegments,c=void 0!==s&&s,u=t.start,l=t.source;return T(this,n),r=e.call(this,"playlist"),E.PARAMCHECK(a),r.isMasterPlaylist=a,r.uri=i,r.version=o,r.independentSegments=c,r.start=u,r.source=l,r}return l(n)}(N),v=function(t){a(n,t);var e=o(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};T(this,n),r.isMasterPlaylist=!0,t=e.call(this,r);var a=r.variants,i=void 0===a?[]:a,o=r.currentVariant,s=r.sessionDataList,c=void 0===s?[]:s,u=r.sessionKeyList,l=void 0===u?[]:u;return t.variants=i,t.currentVariant=o,t.sessionDataList=c,t.sessionKeyList=l,t}return l(n)}(y),X=function(t){a(n,t);var e=o(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};T(this,n),r.isMasterPlaylist=!1,t=e.call(this,r);var a=r.targetDuration,i=r.mediaSequenceBase,o=void 0===i?0:i,s=r.discontinuitySequenceBase,c=void 0===s?0:s,u=r.endlist,l=void 0!==u&&u,E=r.playlistType,f=r.isIFrame,I=r.segments,h=void 0===I?[]:I,A=r.prefetchSegments,p=void 0===A?[]:A,d=r.lowLatencyCompatibility,S=r.partTargetDuration,N=r.renditionReports,y=void 0===N?[]:N,v=r.skip,X=void 0===v?0:v,m=r.hash;return t.targetDuration=a,t.mediaSequenceBase=o,t.discontinuitySequenceBase=c,t.endlist=l,t.playlistType=E,t.isIFrame=f,t.segments=h,t.prefetchSegments=p,t.lowLatencyCompatibility=d,t.partTargetDuration=S,t.renditionReports=y,t.skip=X,t.hash=m,t}return l(n)}(y),m=function(t){a(n,t);var e=o(n);function n(t){var r,a=t.uri,i=t.mimeType,o=t.data,s=t.duration,c=t.title,u=t.byterange,l=t.discontinuity,E=t.mediaSequenceNumber,f=void 0===E?0:E,I=t.discontinuitySequence,h=void 0===I?0:I,A=t.key,p=t.map,d=t.programDateTime,S=t.dateRange,N=t.markers,y=void 0===N?[]:N,v=t.parts,X=void 0===v?[]:v;return T(this,n),(r=e.call(this,"segment")).uri=a,r.mimeType=i,r.data=o,r.duration=s,r.title=c,r.byterange=u,r.discontinuity=l,r.mediaSequenceNumber=f,r.discontinuitySequence=h,r.key=A,r.map=p,r.programDateTime=d,r.dateRange=S,r.markers=y,r.parts=X,r}return l(n)}(N),R=function(t){a(n,t);var e=o(n);function n(t){var r,a=t.hint,i=void 0!==a&&a,o=t.uri,s=t.duration,c=t.independent,u=t.byterange,l=t.gap;return T(this,n),r=e.call(this,"part"),E.PARAMCHECK(o),r.hint=i,r.uri=o,r.duration=s,r.independent=c,r.duration=s,r.byterange=u,r.gap=l,r}return l(n)}(N),L=function(t){a(n,t);var e=o(n);function n(t){var r,a=t.uri,i=t.discontinuity,o=t.mediaSequenceNumber,s=void 0===o?0:o,c=t.discontinuitySequence,u=void 0===c?0:c,l=t.key;return T(this,n),r=e.call(this,"prefetch"),E.PARAMCHECK(a),r.uri=a,r.discontinuity=i,r.mediaSequenceNumber=s,r.discontinuitySequence=u,r.key=l,r}return l(n)}(N),D=l((function t(e){var n=e.uri,r=e.lastMSN,a=e.lastPart;T(this,t),E.PARAMCHECK(n),this.uri=n,this.lastMSN=r,this.lastPart=a}));t.exports={Rendition:f,Variant:I,SessionData:h,Key:A,MediaInitializationSection:p,DateRange:d,SpliceInfo:S,Playlist:y,MasterPlaylist:v,MediaPlaylist:X,Segment:m,PartialSegment:R,PrefetchSegment:L,RenditionReport:D}},771:t=>{function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(t,e)||r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function r(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i={};function o(t){if(i.strictMode)throw t;i.silent||console.error(t.message)}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if("number"==typeof t)return t;var n=10===e?Number.parseFloat(t,e):Number.parseInt(t,e);return Number.isNaN(n)?0:n}t.exports={THROW:o,ASSERT:function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];var s,c=n(a.entries());try{for(c.s();!(s=c.n()).done;){var u=e(s.value,2),l=u[0],T=u[1];T||o(new Error("".concat(t," : Failed at [").concat(l,"]")))}}catch(t){c.e(t)}finally{c.f()}},CONDITIONALASSERT:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i,s=n(r.entries());try{for(s.s();!(i=s.n()).done;){var c=e(i.value,2),u=c[0],l=e(c[1],2),T=l[0],E=l[1];T&&(E||o(new Error("Conditional Assert : Failed at [".concat(u,"]"))))}}catch(t){s.e(t)}finally{s.f()}},PARAMCHECK:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i,s=n(r.entries());try{for(s.s();!(i=s.n()).done;){var c=e(i.value,2),u=c[0],l=c[1];void 0===l&&o(new Error("Param Check : Failed at [".concat(u,"]")))}}catch(t){s.e(t)}finally{s.f()}},CONDITIONALPARAMCHECK:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i,s=n(r.entries());try{for(s.s();!(i=s.n()).done;){var c=e(i.value,2),u=c[0],l=e(c[1],2),T=l[0],E=l[1];T&&void 0===E&&o(new Error("Conditional Param Check : Failed at [".concat(u,"]")))}}catch(t){s.e(t)}finally{s.f()}},INVALIDPLAYLIST:function(t){o(new Error("Invalid Playlist : ".concat(t)))},toNumber:s,hexToByteSequence:function(t){(t.startsWith("0x")||t.startsWith("0X"))&&(t=t.slice(2));for(var e=[],n=0;n<t.length;n+=2)e.push(s(t.slice(n,n+2),16));return Buffer.from(e)},byteSequenceToHex:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length;n<=e&&o(new Error("end must be larger than start : start=".concat(e,", end=").concat(n)));for(var r=[],a=e;a<n;a++)r.push("0".concat((255&t[a]).toString(16).toUpperCase()).slice(-2));return"0x".concat(r.join(""))},tryCatch:function(t,e){try{return t()}catch(t){return e(t)}},splitAt:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=-1,a=0,i=0;a<t.length;a++)if(t[a]===e){if(i++===n)return[t.slice(0,a),t.slice(a+1)];r=a}return-1!==r?[t.slice(0,r),t.slice(r+1)]:[t]},trim:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t?(t=t.trim()," "===e||(t.startsWith(e)&&(t=t.slice(1)),t.endsWith(e)&&(t=t.slice(0,-1))),t):t},splitByCommaWithPreservingQuotes:function(t){for(var e=[],n=!0,r=0,a=[],i=0;i<t.length;i++){var o=t[i];n&&","===o?(e.push(t.slice(r,i).trim()),r=i+1):'"'!==o&&"'"!==o||(n?(a.push(o),n=!1):o===a[a.length-1]?(a.pop(),n=!0):a.push(o))}return e.push(t.slice(r).trim()),e},camelify:function(t){var e,r=[],a=!1,i=n(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;"-"!==o&&"_"!==o?a?(r.push(o.toUpperCase()),a=!1):r.push(o.toLowerCase()):a=!0}}catch(t){i.e(t)}finally{i.f()}return r.join("")},formatDate:function(t){var e=t.getUTCFullYear(),n=("0"+(t.getUTCMonth()+1)).slice(-2),r=("0"+t.getUTCDate()).slice(-2),a=("0"+t.getUTCHours()).slice(-2),i=("0"+t.getUTCMinutes()).slice(-2),o=("0"+t.getUTCSeconds()).slice(-2),s=("00"+t.getUTCMilliseconds()).slice(-3);return"".concat(e,"-").concat(n,"-").concat(r,"T").concat(a,":").concat(i,":").concat(o,".").concat(s,"Z")},hasOwnProp:function(t,e){return Object.hasOwnProperty.call(t,e)},setOptions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i=Object.assign(i,t)},getOptions:function(){return Object.assign({},i)}}}},e={},n=function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}(851),n;var t,e,n}));
//# sourceMappingURL=hls-parser.min.js.map